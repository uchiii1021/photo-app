<div class="page">
  <div class="room-form">
    <h1 class="form-title">DM</h1>
    <h3 class="room-user">
      <% @user_rooms.each do |ur| %>
        <% if ur.user_id != current_user.id %>
          <%= link_to user_path(ur.user) do %>
            <%= ur.user.name %>さん
          <% end %>
        <% end %>
      <% end %>
    </h3>

    <% if @messages.present? %>
      <% @messages.each do |m| %>
        <div class="messages">
          <% if m.message_content? %>
            <% if m.user_id == current_user.id %>
              <div class="right-messages">
                <div class="right-message">
                <p class="message"><%=safe_join(m.message_content.split("\n"),tag(:br))%></p>
                </div>
              </div>
            <% else %>
              <div class="left-messages">
                <div class="left-message">
                  <p class="message"><%=safe_join(m.message_content.split("\n"),tag(:br))%></p>
                </div>
              </div>
            <% end %>
          <% end %>
        </div>
      <% end %>
    <% else %>
      <h3 class="text-center">メッセージはまだありません</h3>
    <% end %>

    
      <%= form_with model: @message, local: true do |f| %>
        <%= f.text_area :message_content, placeholder: "メッセージを入力して下さい", class: "input-area" %><br />
        <%= f.hidden_field :room_id, value: @room.id %>
        <%= f.submit '送信', class: "btn btn-primary" %>
      <% end %>
    
  </div>
</div>
